{% extends "uweflix/layout.html" %}
{% load static %}
{% block title %}
    Add a showing
{% endblock %}
{% block content %}
<h1>Add Showing</h1>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css" />
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>

<script>
    jQuery(function($) {
        $("#id_time").datetimepicker({
        changeMonth: true,
        changeYear: true});
    });

    function updateShowingLink() {
        var selectedValue = $("#selected-showing").val();
        var editShowingLink = $('#edit-showing-link');
        if (selectedValue !== 'no-results') {
            var href = '{% url 'edit_showing' showing_id=4 %}'.replace(/showing_id=\d+/, 'showing_id=' + selectedValue);
            editShowingLink.attr('href', href);
        } 
        else {
            editShowingLink.removeAttr('href');
        }
    }
</script>

<form method="post" class="form-area" autocomplete="off">
    <hr>
    {% csrf_token %}
    <div class="form-group">
        {{ form.as_p}}
    </div>
    <br/>
    <br/>
    <hr>
    <div class="form-group">
        <button id="confirm-btn" type="submit" class="btn btn-warning">Add Showing</button>
        <label for="selected_showing">Select Showing:</label>
        <select id="selected-showing" name="selected_showing" onchange="updateShowingLink()">
            <option value="no-results">Select a showing</option>
            {% for option in options %}
                <option value="{{ option.id }}">{{ option }}</option>
            {% endfor %}
        </select>
        <a href="#" class="btn btn-warning" id="edit-showing-link">Edit Showing</a>

    </div>
</form>

{% endblock %}
